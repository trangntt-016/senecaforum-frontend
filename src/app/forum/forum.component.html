<p-menubar [model]="items" styleClass="parent" (click)="reload()"></p-menubar>

<br>
         
<div class="table-responsive-sm table-responsive-md table-responsive-lg">
    <table class="table text-secondary table-striped">
        <thead>
          <tr>
            <th scope="col w-10"></th>
            <th scope="col w-40"></th>
            <th scope="col w-10"></th>
            <th scope="col w-10"></th>
            <th scope="col w-20"></th>
            <th scope="col w-10">
                <button mat-icon-button color="primary"aria-label="Filter icon" class="position-relative" (click)="handleDisplayFilter($event)">
                    <mat-icon><i class="pi pi-filter"></i></mat-icon>
                    <span class="position-absolute badge form"> 
                        <form #f='ngForm' (ngSubmit)='onSubmit(f)' class="container position-absolute top-0 start-100" *ngIf="isDisplayFilter">
                            <h2>Show only</h2>
                                <div fxLayout="column">
                                    <mat-form-field appearance="fill" class="full-width-input">
                                        <mat-label>Find By Tag</mat-label>
                                        <input matInput placeholder="Tag" [matAutocomplete]="auto" name="searchTag" #searchTag="ngModel" [(ngModel)]="currentTag" (ngModelChange)="doFilter()">
                                        <mat-autocomplete #auto="matAutocomplete">
                                          <mat-option *ngFor="let tag of tags | async" [value]="tag.tagName">
                                            {{tag.tagName}}
                                          </mat-option>
                                        </mat-autocomplete>
                                    </mat-form-field>
                    
                                    <mat-form-field appearance="fill">
                                        <mat-label>Enter a date range</mat-label>
                                        <mat-date-range-input [rangePicker]="picker">
                                          <input matStartDate [(ngModel)]="filteredKeyword.start" name="start" placeholder="Start date">
                                          <input matEndDate [(ngModel)]="filteredKeyword.end" name="end" placeholder="End date">
                                        </mat-date-range-input>
                                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                        <mat-date-range-picker #picker></mat-date-range-picker>
                                      </mat-form-field>
                                    <mat-form-field>
                                        <mat-select name="sortedBy" [(ngModel)]="filteredKeyword.sortedBy" placeholder = "Sorted By">
                                            <mat-option [value]="'posts'">Posts </mat-option>
                                            <mat-option [value]="'comments'">Comments</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                    <mat-form-field>
                                        <mat-label>Order</mat-label>
                                        <mat-select name="order" [(ngModel)]="filteredKeyword.order" placeholder = "Order">
                                            <mat-option [value]="'ascending'">Ascending</mat-option>
                                            <mat-option [value]="'descending'">Descending</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                    
                                </div>            
                                <button mat-raised-button>
                                    <mat-icon  style="opacity:.5">search</mat-icon>
                                    <span style="opacity:.5">&nbsp;&nbsp;&nbsp;Filter</span>
                                </button>
                        </form>
                    </span>
                </button>
            </th>
          </tr>
        </thead>

        <tbody>
            <tr *ngFor="let p of posts">
                <td class="w-10">
                    <div class="p-1 trigger">
                        <img id="authorAvatarUrl" src="https://github.com/SiddAjmera.png" alt="authorAvatar" class="position-relative">
                    
                        <!-- <span class="position-absolute toolTip" *ngIf="p.author.discord">
                            <div class="card" style="width: 17rem;">
                                <div class="card-body">
                                    <div class="d-flex flex-row justify-content-between">
                                        <h4>Add {{p.author.username}}'s <i class="pi pi-discord"></i>: {{p.author.discord}}</h4>
                                    </div>          
                                </div>
                            </div>
                        </span> -->

                    </div>

                </td>
                <td class="w-40">
                    <h3>{{p.title}}</h3>
                    <h5>{{p.author.username}} created on {{p.createdOn | date}}</h5>
                </td>
                <td class="w-10">
                    <h3>Comments:</h3>
                    <h5>Views:  </h5>
                </td>
                <td class="w-10">
                    <h3>{{p.comments.length}}</h3>
                    <h5>{{p.views}}</h5>
                </td>
                <td class="w-20">
                    <div class="d-flex flex-column align-items-end" *ngIf="p.comments.length>0">
                        <h3>{{convertDateLastComment(p.comments[0].createdOn)}}</h3>
                        <h5>Last comment by: {{p.comments[0].commenter.username}}</h5>
                    </div>
                </td>
                <td class="w-10">
                    <div class="pt-2 pl-1 trigger" *ngIf="p.comments.length>0">
                        <img id="replierAvatarUrl" src="https://github.com/SiddAjmera.png" alt="replierAvatar" class="position-relative">
                        
                        <!-- <span class="position-absolute toolTip" id="replierCard">
                            <div class="card" style="width: 15rem;">
                                <div class="card-body">
                                    <div class="d-flex flex-row justify-content-between">
                                        <h4>{{p.comments[0].commenter.username}}'s Discord:</h4>
                                        <h4> {{p.comments[0].commenter.discord}}</h4>
                                    </div> 
                                    <div class="d-flex flex-row justify-content-between">
                                        <div class="d-flex flex-column">
                                            <h5>Posts</h5>
                                            <h5>{{p.replier.noOfPosts}}</h5>
                                        </div>
                                        <div class="d-flex flex-column">
                                            <h5>Replies</h5>
                                            <h5>{{p.replier.noOfReplies}}</h5>
                                        </div>
                                        <div class="d-flex flex-column">
                                            <h5>Join On</h5>
                                            <h5>{{p.replier.createdOn|date}}</h5>
                                        </div>
                                    </div>            
                                </div>
                            </div>
                        </span> -->
                        
                    </div>

                </td>
          </tr>
        </tbody>
      </table>
    </div>



    <mat-paginator [length]="length"
    [pageSize]="pageSize"
    (page)="pageEvent($event)">
    </mat-paginator>

