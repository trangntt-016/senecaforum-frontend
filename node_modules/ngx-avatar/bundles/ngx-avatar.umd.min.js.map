{"version":3,"sources":["../../../projects/ngx-avatar/src/lib/sources/async-source.ts","../../../projects/ngx-avatar/src/lib/sources/avatar-source.enum.ts","../../../projects/ngx-avatar/src/lib/sources/facebook.ts","../../../projects/ngx-avatar/src/lib/sources/twitter.ts","../../../node_modules/tslib/tslib.es6.js","../../../projects/ngx-avatar/src/lib/sources/google.ts","../../../projects/ngx-avatar/src/lib/sources/instagram.ts","../../../projects/ngx-avatar/src/lib/sources/custom.ts","../../../projects/ngx-avatar/src/lib/sources/initials.ts","../../../projects/ngx-avatar/src/lib/sources/gravatar.ts","../../../projects/ngx-avatar/src/lib/sources/skype.ts","../../../projects/ngx-avatar/src/lib/sources/value.ts","../../../projects/ngx-avatar/src/lib/sources/vkontakte.ts","../../../projects/ngx-avatar/src/lib/sources/github.ts","../../../projects/ngx-avatar/src/lib/sources/source.factory.ts","../../../projects/ngx-avatar/src/lib/avatar-config.token.ts","../../../projects/ngx-avatar/src/lib/avatar-config.service.ts","../../../projects/ngx-avatar/src/lib/avatar.service.ts","../../../projects/ngx-avatar/src/lib/avatar.component.ts","../../../projects/ngx-avatar/src/lib/avatar.module.ts"],"names":["AvatarSource","AsyncSource","sourceId","this","Facebook","sourceType","FACEBOOK","prototype","getAvatar","size","Twitter","TWITTER","twitterImgSize","getImageSize","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","call","__extends","TypeError","String","__","constructor","create","__read","o","n","m","Symbol","iterator","r","e","i","ar","next","done","push","value","error","__spread","arguments","length","concat","Google","_super","_this","GOOGLE","processResponse","data","avatarSrc","entry","gphoto$thumbnail","$t","replace","Instagram","INSTAGRAM","graphql","user","profile_pic_url_hd","Custom","CUSTOM","Initials","INITIALS","getInitials","name","trim","initials","split","constructInitials","slice","elements","filter","element","map","toUpperCase","join","Gravatar","GRAVATAR","match","Md5","hashStr","toString","avatarSize","window","devicePixelRatio","matchMedia","matches","isRetina","Skype","SKYPE","Value","VALUE","Vkontakte","VKONTAKTE","imgSize","sizeProperty","keys","pop","Github","GITHUB","avatar_url","SourceFactory","sources","newInstance","sourceValue","Injectable","AVATAR_CONFIG","InjectionToken","AvatarConfigService","userConfig","getAvatarSources","defaultSources","sourcePriorityOrder","validSources_1","Set","source","includes","getAvatarColors","defaultColors","colors","Optional","type","Inject","args","AvatarService","http","avatarConfigService","avatarSources","avatarColors","failedSources","Map","overrideAvatarSources","overrideAvatarColors","fetchAvatar","avatarUrl","get","getRandomColor","avatarText","asciiCodeSum","calculateAsciiCode","compareSources","sourceType1","sourceType2","getSourcePriority","isSource","isTextAvatar","buildSourceKey","sourceHasFailedBefore","has","markSourceAsFailed","set","letter","charCodeAt","reduce","previous","current","indexOf","HttpClient","AvatarComponent","sourceFactory","avatarService","round","textSizeRatio","fgColor","style","cornerRadius","initialsSize","clickOnAvatar","EventEmitter","isAlive","avatarStyle","hostStyle","currentIndex","onAvatarClicked","emit","ngOnChanges","changes","propName","currentValue","addSource","removeSource","initializeAvatar","fetchAvatarSource","previousSource","findNextSource","buildTextAvatar","buildImageAvatar","ngOnDestroy","sortAvatarSources","width","height","sort","source1","source2","avatarSource","getInitialsStyle","getImageStyle","fetchAndProcessAsyncAvatar","avatarValue","assign","textAlign","borderRadius","border","borderColor","textTransform","color","backgroundColor","bgColor","font","Math","floor","lineHeight","maxWidth","pipe","takeWhile","response","subscribe","err","find","s","Component","selector","template","Input","Output","AvatarModule","forRoot","avatarConfig","ngModule","providers","provide","useValue","NgModule","imports","CommonModule","declarations","exports"],"mappings":"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","sourcesContent":["import { Source } from './source';\nimport { AvatarSource } from './avatar-source.enum';\n\n/**\n * Contract of all async sources.\n * Every async source must implement the processResponse method that extracts the avatar url from the data\n */\nexport abstract class AsyncSource implements Source {\n  readonly abstract sourceType: AvatarSource;\n\n  constructor(public sourceId: string) {}\n\n  abstract getAvatar(size: number): string;\n  abstract processResponse(data: unknown, size?: number): string | null;\n}\n","export enum AvatarSource {\n  FACEBOOK = 'facebook',\n  GOOGLE = 'google',\n  TWITTER = 'twitter',\n  INSTAGRAM = 'instagram',\n  VKONTAKTE = 'vkontakte',\n  SKYPE = 'skype',\n  GRAVATAR = 'gravatar',\n  GITHUB = 'github',\n  CUSTOM = 'custom',\n  INITIALS = 'initials',\n  VALUE = 'value'\n}\n","import { Source } from './source';\nimport { AvatarSource } from './avatar-source.enum';\n/**\n *  Facebook source implementation.\n *  Fetch avatar source based on facebook identifier\n *  and image size\n */\nexport class Facebook implements Source {\n  readonly sourceType: AvatarSource = AvatarSource.FACEBOOK;\n\n  constructor(public sourceId: string) {}\n\n  public getAvatar(size: number): string {\n    return (\n      'https://graph.facebook.com/' +\n      `${this.sourceId}/picture?width=${size}&height=${size}`\n    );\n  }\n}\n","import { Source } from './source';\nimport { AvatarSource } from './avatar-source.enum';\n\n/**\n *  Twitter source implementation.\n *  Fetch avatar source based on google identifier\n *  and image size\n */\nexport class Twitter implements Source {\n  readonly sourceType: AvatarSource = AvatarSource.TWITTER;\n\n  constructor(public sourceId: string) {}\n\n  public getAvatar(size: number): string {\n    const twitterImgSize = this.getImageSize(size);\n    return `https://twitter.com/${\n      this.sourceId\n    }/profile_image?size=${twitterImgSize}`;\n  }\n\n  private getImageSize(size: number) {\n    if (size <= 24) {\n      return 'mini';\n    }\n\n    if (size <= 48) {\n      return 'normal';\n    }\n\n    if (size <= 73) {\n      return 'bigger';\n    }\n\n    return 'original';\n  }\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { AsyncSource } from './async-source';\nimport { AvatarSource } from './avatar-source.enum';\n\n/**\n *  Google source implementation.\n *  Fetch avatar source based on google identifier\n *  and image size\n */\nexport class Google extends AsyncSource {\n  readonly sourceType: AvatarSource = AvatarSource.GOOGLE;\n\n  constructor(sourceId: string) {\n    super(sourceId);\n  }\n\n  public getAvatar(): string {\n    return `https://picasaweb.google.com/data/entry/api/user/${\n      this.sourceId\n    }?alt=json`;\n  }\n\n  /**\n   * Extract google avatar from json data\n   */\n  public processResponse(data: { entry: { gphoto$thumbnail: { $t: string } } }, size?: number): string | null {\n    const avatarSrc = data.entry.gphoto$thumbnail.$t;\n    if (avatarSrc) {\n      return avatarSrc.replace('s64', 's' + size);\n    }\n\n    return null;\n  }\n}\n","import { AsyncSource } from './async-source';\nimport { AvatarSource } from './avatar-source.enum';\n\n/**\n *  Instagram source impelementation.\n *  Fetch avatar source based on instagram identifier\n */\nexport class Instagram extends AsyncSource {\n  readonly sourceType: AvatarSource = AvatarSource.INSTAGRAM;\n\n  constructor(sourceId: string) {\n    super(sourceId);\n  }\n\n  public getAvatar(): string {\n    return `https://www.instagram.com/${this.sourceId}/?__a=1`;\n  }\n\n  /**\n   * extract instagram avatar from json data\n   */\n  public processResponse(data: { graphql: { user: { profile_pic_url_hd: string } } }, size?: number): string {\n    return `${data.graphql.user.profile_pic_url_hd}&s=${size}`;\n  }\n}\n","import { Source } from './source';\nimport { AvatarSource } from './avatar-source.enum';\n/**\n *  Custom source implementation.\n *  return custom image as an avatar\n *\n */\nexport class Custom implements Source {\n  readonly sourceType: AvatarSource = AvatarSource.CUSTOM;\n\n  constructor(public sourceId: string) {}\n\n  public getAvatar(): string {\n    return this.sourceId;\n  }\n}\n","import { Source } from './source';\nimport { AvatarSource } from './avatar-source.enum';\n\n/**\n * Initials source implementation.\n * return the initials of the given value\n */\nexport class Initials implements Source {\n  readonly sourceType: AvatarSource = AvatarSource.INITIALS;\n\n  constructor(public sourceId: string) {}\n\n  public getAvatar(size: number): string {\n    return this.getInitials(this.sourceId, size);\n  }\n\n  /**\n   * Returns the initial letters of a name in a string.\n   */\n  private getInitials(name: string, size: number): string {\n    name = name.trim();\n\n    if (!name) {\n      return '';\n    }\n\n    const initials = name.split(' ');\n\n    if (size && size < initials.length) {\n      return this.constructInitials(initials.slice(0, size));\n    } else {\n      return this.constructInitials(initials);\n    }\n  }\n\n  /**\n   * Iterates a person's name string to get the initials of each word in uppercase.\n   */\n  private constructInitials(elements: string[]): string {\n    if (!elements || !elements.length) {\n      return '';\n    }\n\n    return elements\n      .filter(element => element && element.length > 0)\n      .map(element => element[0].toUpperCase())\n      .join('');\n  }\n}\n","import { Md5 } from 'ts-md5';\nimport { Source } from './source';\nimport { AvatarSource } from './avatar-source.enum';\n\nfunction isRetina(): boolean {\n  if (typeof window !== 'undefined' && window !== null) {\n    if (window.devicePixelRatio > 1.25) {\n      return true;\n    }\n\n    const mediaQuery = '(-webkit-min-device-pixel-ratio: 1.25), (min--moz-device-pixel-ratio: 1.25), (-o-min-device-pixel-ratio: 5/4), (min-resolution: 1.25dppx)';\n    if (window.matchMedia && window.matchMedia(mediaQuery).matches) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n *  Gravatar source implementation.\n *  Fetch avatar source based on gravatar email\n */\nexport class Gravatar implements Source {\n  readonly sourceType: AvatarSource = AvatarSource.GRAVATAR;\n  public sourceId: string;\n\n  constructor(public value: string) {\n    this.sourceId = value.match('^[a-f0-9]{32}$')\n      ? value\n      : Md5.hashStr(value).toString();\n  }\n\n  public getAvatar(size: number): string {\n    const avatarSize = isRetina() ? size * 2 : size;\n    return `https://secure.gravatar.com/avatar/${\n      this.sourceId\n    }?s=${avatarSize}&d=404`;\n  }\n}\n","import { Source } from './source';\nimport { AvatarSource } from './avatar-source.enum';\n/**\n *  Skype source implementation.\n *  Fetch avatar source based on skype identifier\n */\nexport class Skype implements Source {\n  readonly sourceType: AvatarSource = AvatarSource.SKYPE;\n\n  constructor(public sourceId: string) {}\n\n  public getAvatar(): string {\n    return `https://api.skype.com/users/${this.sourceId}/profile/avatar`;\n  }\n}\n","import { Source } from './source';\nimport { AvatarSource } from './avatar-source.enum';\n\n/**\n *  Value source implementation.\n *  return the value as avatar\n */\nexport class Value implements Source {\n  readonly sourceType: AvatarSource = AvatarSource.VALUE;\n\n  constructor(public sourceId: string) {}\n\n  public getAvatar(): string {\n    return this.sourceId;\n  }\n}\n","import { AsyncSource } from './async-source';\nimport { AvatarSource } from './avatar-source.enum';\n\n/**\n *  Vkontakte source implementation.\n *  Fetch avatar source based on vkontakte identifier\n *  and image size\n */\nconst apiVersion = 5.8;\n\nexport class Vkontakte extends AsyncSource {\n  readonly sourceType: AvatarSource = AvatarSource.VKONTAKTE;\n\n  constructor(sourceId: string) {\n    super(sourceId);\n  }\n\n  public getAvatar(size: number): string {\n    const imgSize = this.getImageSize(size);\n    return `https://api.vk.com/method/users.get?user_id=${\n      this.sourceId\n    }&v=${apiVersion}&fields=${imgSize}`;\n  }\n\n  /**\n   * extract vkontakte avatar from json data\n   */\n  public processResponse(data: {\n    response: {\n      [key: string]: string;\n    }[]\n  }): string | null {\n    // avatar key property is the size used to generate avatar url\n    // size property is always the last key in the response object\n    const sizeProperty = Object.keys(data['response'][0]).pop();\n    if (!sizeProperty) {\n      return null;\n    }\n    // return avatar src\n    return data['response'][0][sizeProperty] || null;\n  }\n\n  /**\n   * Returns image size related to vkontakte API\n   */\n  private getImageSize(size: number): string {\n    if (size <= 50) {\n      return 'photo_50';\n    }\n\n    if (size <= 100) {\n      return 'photo_100';\n    }\n\n    if (size <= 200) {\n      return 'photo_200';\n    }\n\n    return 'photo_max';\n  }\n}\n","import { AsyncSource } from './async-source';\nimport { AvatarSource } from './avatar-source.enum';\n\n/**\n *  GitHub source implementation.\n *  Fetch avatar source based on github identifier\n */\nexport class Github extends AsyncSource {\n  readonly sourceType: AvatarSource = AvatarSource.GITHUB;\n\n  constructor(sourceId: string) {\n    super(sourceId);\n  }\n\n  public getAvatar(): string {\n    return `https://api.github.com/users/${this.sourceId}`;\n  }\n\n  /**\n   * extract github avatar from json data\n   */\n  public processResponse(data: { avatar_url: string }, size?: number): string {\n    if (size) {\n      return `${data.avatar_url}&s=${size}`;\n    }\n    return data.avatar_url;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Source } from './source';\nimport { Facebook } from './facebook';\nimport { Twitter } from './twitter';\nimport { Google } from './google';\nimport { Instagram } from './instagram';\nimport { Custom } from './custom';\nimport { Initials } from './initials';\nimport { Gravatar } from './gravatar';\nimport { Skype } from './skype';\nimport { Value } from './value';\nimport { Vkontakte } from './vkontakte';\nimport { Github } from './github';\nimport { SourceCreator } from './source.creator';\nimport { AvatarSource } from './avatar-source.enum';\n\n/**\n * Factory class that implements factory method pattern.\n * Used to create Source implementation class based\n * on the source Type\n */\n@Injectable()\nexport class SourceFactory {\n  private sources: { [key: string]: SourceCreator } = {};\n\n  constructor() {\n    this.sources[AvatarSource.FACEBOOK] = Facebook;\n    this.sources[AvatarSource.TWITTER] = Twitter;\n    this.sources[AvatarSource.GOOGLE] = Google;\n    this.sources[AvatarSource.INSTAGRAM] = Instagram;\n    this.sources[AvatarSource.SKYPE] = Skype;\n    this.sources[AvatarSource.GRAVATAR] = Gravatar;\n    this.sources[AvatarSource.CUSTOM] = Custom;\n    this.sources[AvatarSource.INITIALS] = Initials;\n    this.sources[AvatarSource.VALUE] = Value;\n    this.sources[AvatarSource.VKONTAKTE] = Vkontakte;\n    this.sources[AvatarSource.GITHUB] = Github;\n  }\n\n  public newInstance(sourceType: AvatarSource, sourceValue: string): Source {\n    return new this.sources[sourceType](sourceValue);\n  }\n}\n","import { InjectionToken } from '@angular/core';\n\nimport { AvatarConfig } from './avatar-config';\n/**\n * Token used to inject the AvatarConfig object\n */\nexport const AVATAR_CONFIG = new InjectionToken<AvatarConfig>('avatar.config');\n","import { Injectable, Inject, Optional } from '@angular/core';\n\nimport { AvatarSource } from './sources/avatar-source.enum';\nimport { AVATAR_CONFIG } from './avatar-config.token';\nimport { AvatarConfig } from './avatar-config';\n\n@Injectable()\nexport class AvatarConfigService {\n  constructor(\n    @Optional()\n    @Inject(AVATAR_CONFIG)\n    public userConfig: AvatarConfig\n  ) {}\n\n  public getAvatarSources(defaultSources: AvatarSource[]): AvatarSource[] {\n    if (\n      this.userConfig &&\n      this.userConfig.sourcePriorityOrder &&\n      this.userConfig.sourcePriorityOrder.length\n    ) {\n      const uniqueSources = [...new Set(this.userConfig.sourcePriorityOrder)];\n      const validSources = uniqueSources.filter(source =>\n        defaultSources.includes(source)\n      );\n      return [\n        ...validSources,\n        ...defaultSources.filter(source => !validSources.includes(source))\n      ];\n    }\n    return defaultSources;\n  }\n\n  public getAvatarColors(defaultColors: string[]): string[] {\n    return (\n      (this.userConfig &&\n        this.userConfig.colors &&\n        this.userConfig.colors.length &&\n        this.userConfig.colors) ||\n      defaultColors\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\n\nimport { Observable } from 'rxjs';\n\nimport { AvatarConfigService } from './avatar-config.service';\nimport { AvatarSource } from './sources/avatar-source.enum';\nimport { Source } from './sources/source';\n\n/**\n * list of Supported avatar sources\n */\nexport const defaultSources = [\n  AvatarSource.FACEBOOK,\n  AvatarSource.GOOGLE,\n  AvatarSource.TWITTER,\n  AvatarSource.INSTAGRAM,\n  AvatarSource.VKONTAKTE,\n  AvatarSource.SKYPE,\n  AvatarSource.GRAVATAR,\n  AvatarSource.GITHUB,\n  AvatarSource.CUSTOM,\n  AvatarSource.INITIALS,\n  AvatarSource.VALUE\n];\n\n/**\n * list of default colors\n */\nexport const defaultColors = [\n  '#1abc9c',\n  '#3498db',\n  '#f1c40f',\n  '#8e44ad',\n  '#e74c3c',\n  '#d35400',\n  '#2c3e50',\n  '#7f8c8d'\n];\n\n/**\n * Provides utilities methods related to Avatar component\n */\n@Injectable()\nexport class AvatarService {\n  public avatarSources: AvatarSource[] = defaultSources;\n  public avatarColors: string[] = defaultColors;\n\n  private readonly failedSources = new Map<string, Source>();\n\n  constructor(\n    private http: HttpClient,\n    private avatarConfigService: AvatarConfigService\n  ) {\n    this.overrideAvatarSources();\n    this.overrideAvatarColors();\n  }\n\n  public fetchAvatar(avatarUrl: string): Observable<unknown> {\n    return this.http.get(avatarUrl);\n  }\n\n  public getRandomColor(avatarText: string): string {\n    if (!avatarText) {\n      return 'transparent';\n    }\n    const asciiCodeSum = this.calculateAsciiCode(avatarText);\n    return this.avatarColors[asciiCodeSum % this.avatarColors.length];\n  }\n\n  public compareSources(\n    sourceType1: AvatarSource,\n    sourceType2: AvatarSource\n  ): number {\n    return (\n      this.getSourcePriority(sourceType1) - this.getSourcePriority(sourceType2)\n    );\n  }\n\n  public isSource(source: string): boolean {\n    return this.avatarSources.includes(source as AvatarSource);\n  }\n\n  public isTextAvatar(sourceType: AvatarSource): boolean {\n    return [AvatarSource.INITIALS, AvatarSource.VALUE].includes(sourceType);\n  }\n\n  private buildSourceKey(source: Source): string {\n    return source.sourceType + '-' + source.sourceId;\n  }\n\n  public sourceHasFailedBefore(source: Source): boolean {\n    return this.failedSources.has(this.buildSourceKey(source));\n  }\n\n  public markSourceAsFailed(source: Source): void {\n    this.failedSources.set(this.buildSourceKey(source), source);\n  }\n\n  private overrideAvatarSources(): void {\n    this.avatarSources = this.avatarConfigService.getAvatarSources(\n      defaultSources\n    );\n  }\n\n  private overrideAvatarColors(): void {\n    this.avatarColors = this.avatarConfigService.getAvatarColors(defaultColors);\n  }\n\n  private calculateAsciiCode(value: string): number {\n    return value\n      .split('')\n      .map(letter => letter.charCodeAt(0))\n      .reduce((previous, current) => previous + current);\n  }\n\n  private getSourcePriority(sourceType: AvatarSource) {\n    return this.avatarSources.indexOf(sourceType);\n  }\n}\n","import {\n  Component,\n  Input,\n  Output,\n  EventEmitter,\n  OnChanges,\n  SimpleChanges,\n  OnDestroy\n} from '@angular/core';\n\nimport { Source } from './sources/source';\nimport { AsyncSource } from './sources/async-source';\nimport { SourceFactory } from './sources/source.factory';\nimport { AvatarService } from './avatar.service';\nimport { AvatarSource } from './sources/avatar-source.enum';\nimport { takeWhile, map } from 'rxjs/operators';\n\ntype Style = Partial<CSSStyleDeclaration>;\n\n/**\n * Universal avatar component that\n * generates avatar from different sources\n *\n * export\n * class AvatarComponent\n * implements {OnChanges}\n */\n\n@Component({\n  // tslint:disable-next-line:component-selector\n  selector: 'ngx-avatar',\n  styles: [\n    `\n      :host {\n        border-radius: 50%;\n      }\n    `\n  ],\n  template: `\n    <div\n      (click)=\"onAvatarClicked()\"\n      class=\"avatar-container\"\n      [ngStyle]=\"hostStyle\"\n    >\n      <img\n        *ngIf=\"avatarSrc; else textAvatar\"\n        [src]=\"avatarSrc\"\n        [width]=\"size\"\n        [height]=\"size\"\n        [ngStyle]=\"avatarStyle\"\n        (error)=\"fetchAvatarSource()\"\n        class=\"avatar-content\"\n        loading=\"lazy\"\n      />\n      <ng-template #textAvatar>\n        <div *ngIf=\"avatarText\" class=\"avatar-content\" [ngStyle]=\"avatarStyle\">\n          {{ avatarText }}\n        </div>\n      </ng-template>\n    </div>\n  `\n})\nexport class AvatarComponent implements OnChanges, OnDestroy {\n  @Input()\n  public round = true;\n  @Input()\n  public size: string | number = 50;\n  @Input()\n  public textSizeRatio = 3;\n  @Input()\n  public bgColor: string | undefined;\n  @Input()\n  public fgColor = '#FFF';\n  @Input()\n  public borderColor: string | undefined;\n  @Input()\n  public style: Style = {};\n  @Input()\n  public cornerRadius: string | number = 0;\n  @Input('facebookId')\n  public facebook?: string | null;\n  @Input('twitterId')\n  public twitter?: string | null;\n  @Input('googleId')\n  public google?: string | null;\n  @Input('instagramId')\n  public instagram?: string | null;\n  @Input('vkontakteId')\n  public vkontakte?: string | null;\n  @Input('skypeId')\n  public skype?: string | null;\n  @Input('gravatarId')\n  public gravatar?: string | null;\n  @Input('githubId')\n  public github?: string | null;\n  @Input('src')\n  public custom?: string | null;\n  @Input('name')\n  public initials?: string | null;\n  @Input()\n  public value?: string | null;\n  @Input()\n  public placeholder?: string;\n  @Input()\n  public initialsSize: string | number = 0;\n\n  @Output()\n  public clickOnAvatar: EventEmitter<Source> = new EventEmitter<Source>();\n\n  public isAlive = true;\n  public avatarSrc: string | null = null;\n  public avatarText: string | null = null;\n  public avatarStyle: Style = {};\n  public hostStyle: Style = {};\n\n  private currentIndex = -1;\n  private sources: Source[] = [];\n\n  constructor(\n    public sourceFactory: SourceFactory,\n    private avatarService: AvatarService\n  ) {}\n\n  public onAvatarClicked(): void {\n    this.clickOnAvatar.emit(this.sources[this.currentIndex]);\n  }\n\n  /**\n   * Detect inputs change\n   *\n   * param {{ [propKey: string]: SimpleChange }} changes\n   *\n   * memberof AvatarComponent\n   */\n  public ngOnChanges(changes: SimpleChanges): void {\n    for (const propName in changes) {\n      if (this.avatarService.isSource(propName)) {\n        const sourceType: AvatarSource = AvatarSource[propName.toUpperCase() as keyof typeof AvatarSource] ;\n        const currentValue = changes[propName].currentValue;\n        if (currentValue && typeof currentValue === 'string') {\n          this.addSource(sourceType, currentValue);\n        } else {\n          this.removeSource(sourceType);\n        }\n      }\n    }\n    // reinitialize the avatar component when a source property value has changed\n    // the fallback system must be re-invoked with the new values.\n    this.initializeAvatar();\n  }\n\n  /**\n   * Fetch avatar source\n   *\n   * memberOf AvatarComponent\n   */\n  public fetchAvatarSource(): void {\n    const previousSource = this.sources[this.currentIndex];\n    if (previousSource) {\n      this.avatarService.markSourceAsFailed(previousSource);\n    }\n\n    const source = this.findNextSource();\n    if (!source) {\n      return;\n    }\n\n    if (this.avatarService.isTextAvatar(source.sourceType)) {\n      this.buildTextAvatar(source);\n      this.avatarSrc = null;\n    } else {\n      this.buildImageAvatar(source);\n    }\n  }\n\n  private findNextSource(): Source | null {\n    while (++this.currentIndex < this.sources.length) {\n      const source = this.sources[this.currentIndex];\n      if (source && !this.avatarService.sourceHasFailedBefore(source)) {\n        return source;\n      }\n    }\n\n    return null;\n  }\n\n  public ngOnDestroy(): void {\n    this.isAlive = false;\n  }\n\n  /**\n   * Initialize the avatar component and its fallback system\n   */\n  private initializeAvatar(): void {\n    this.currentIndex = -1;\n    if (this.sources.length > 0) {\n      this.sortAvatarSources();\n      this.fetchAvatarSource();\n      this.hostStyle = {\n        width: this.size + 'px',\n        height: this.size + 'px'\n      };\n    }\n  }\n\n  private sortAvatarSources(): void {\n    this.sources.sort((source1, source2) =>\n      this.avatarService.compareSources(source1.sourceType, source2.sourceType)\n    );\n  }\n\n  private buildTextAvatar(avatarSource: Source): void {\n    this.avatarText = avatarSource.getAvatar(+this.initialsSize);\n    this.avatarStyle = this.getInitialsStyle(avatarSource.sourceId);\n  }\n\n  private buildImageAvatar(avatarSource: Source): void {\n    this.avatarStyle = this.getImageStyle();\n    if (avatarSource instanceof AsyncSource) {\n      this.fetchAndProcessAsyncAvatar(avatarSource);\n    } else {\n      this.avatarSrc = avatarSource.getAvatar(+this.size);\n    }\n  }\n\n  /**\n   *\n   * returns initials style\n   *\n   * memberOf AvatarComponent\n   */\n  private getInitialsStyle(avatarValue: string): Style {\n    return {\n      textAlign: 'center',\n      borderRadius: this.round ? '100%' : this.cornerRadius + 'px',\n      border: this.borderColor ? '1px solid ' + this.borderColor : '',\n      textTransform: 'uppercase',\n      color: this.fgColor,\n      backgroundColor: this.bgColor\n        ? this.bgColor\n        : this.avatarService.getRandomColor(avatarValue),\n      font:\n        Math.floor(+this.size / this.textSizeRatio) +\n        'px Helvetica, Arial, sans-serif',\n      lineHeight: this.size + 'px',\n      ...this.style\n    };\n  }\n\n  /**\n   *\n   * returns image style\n   *\n   * memberOf AvatarComponent\n   */\n  private getImageStyle(): Style {\n    return {\n      maxWidth: '100%',\n      borderRadius: this.round ? '50%' : this.cornerRadius + 'px',\n      border: this.borderColor ? '1px solid ' + this.borderColor : '',\n      width: this.size + 'px',\n      height: this.size + 'px',\n      ...this.style,\n    };\n  }\n  /**\n   * Fetch avatar image asynchronously.\n   *\n   * param {Source} source represents avatar source\n   * memberof AvatarComponent\n   */\n  private fetchAndProcessAsyncAvatar(source: AsyncSource): void {\n    if (this.avatarService.sourceHasFailedBefore(source)) {\n      return;\n    }\n\n    this.avatarService\n        .fetchAvatar(source.getAvatar(+this.size))\n        .pipe(\n            takeWhile(() => this.isAlive),\n            map(response => source.processResponse(response, +this.size)),\n        )\n        .subscribe(\n            avatarSrc => (this.avatarSrc = avatarSrc),\n            err => {\n              this.fetchAvatarSource();\n            },\n        );\n  }\n\n  /**\n   * Add avatar source\n   *\n   * param sourceType avatar source type e.g facebook,twitter, etc.\n   * param sourceValue  source value e.g facebookId value, etc.\n   */\n  private addSource(sourceType: AvatarSource, sourceValue: string): void {\n    const source = this.sources.find(s => s.sourceType === sourceType);\n    if (source) {\n      source.sourceId = sourceValue;\n    } else {\n      this.sources.push(\n          this.sourceFactory.newInstance(sourceType, sourceValue),\n      );\n    }\n  }\n\n  /**\n   * Remove avatar source\n   *\n   * param sourceType avatar source type e.g facebook,twitter, etc.\n   */\n  private removeSource(sourceType: AvatarSource): void {\n    this.sources = this.sources.filter(source => source.sourceType !== sourceType);\n  }\n}\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { AvatarComponent } from './avatar.component';\nimport { SourceFactory } from './sources/source.factory';\nimport { AvatarService } from './avatar.service';\nimport { AvatarConfig } from './avatar-config';\nimport { AVATAR_CONFIG } from './avatar-config.token';\nimport { AvatarConfigService } from './avatar-config.service';\n\n@NgModule({\n  imports: [CommonModule],\n  declarations: [AvatarComponent],\n  providers: [SourceFactory, AvatarService, AvatarConfigService],\n  exports: [AvatarComponent]\n})\nexport class AvatarModule {\n  static forRoot(avatarConfig?: AvatarConfig): ModuleWithProviders<AvatarModule> {\n    return {\n      ngModule: AvatarModule,\n      providers: [\n        { provide: AVATAR_CONFIG, useValue: avatarConfig ? avatarConfig : {} }\n      ]\n    };\n  }\n}\n"]}